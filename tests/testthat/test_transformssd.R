library(xrfr)

test_that("output is correct", {
  a <- "53 53 44 33 12 00 00 00 73 61 6d 70 6c 65 30 30 31 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 41 64 6D 69 6E 00 00 00 00 00 00 00 00 00 00 00 30 31 2d 4a 61 6e 2d 32 30 32 30 20 31 34 3a 30 30 3a 30 30 01 00 52 68 00 00 B4 42 00 00 7C 42 00 00 96 42 15 A8 00 00 00 40 38 44 69 19 1F BA 52 7E E4 40 23 1F 5D B0 75 13 92 42 1C A0 3E 3D CC 52 F8 0E 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 18 01 00 00 10 00 05 00 CD CC 4C 3E 80 6A 3C 3D 8F DE 07 42 E2 86 96 3F 01 06 AB 02 4C 69 46 32 30 30 00 00 FE D4 80 40 01 00 02 00 4E 61 49 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 9A 99 99 3E 67 66 66 41 67 66 06 42 B9 1E 05 3F 30 2E 34 36 20 64 65 67 72 2E 00 00 00 00 00 00 33 34 20 6D 6D 00 00 00 00 00 00 00 00 00 00 00 4E 6F 6E 65 00 00 00 00 00 00 00 00 00 00 00 00 00 00 34 42 3C 00 3A 00 A3 00 00 00 00 00 09 00 10 00 8E 34 06 3C C1 CD 45 BC F8 EC 50 BC 00 00 00 00 1E 00 16 00 41 73 20 4B 41 31 2D 48 53 2D 4D 69 6E 2F 41 6C 67 65 72 47 46 46 14 00 08 00 7B 14 14 42 97 93 50 3C 10 00 1A 00 00 00 41 73 20 4B 41 31 2D 48 53 2D 4D 69 8F DE 07 42 00 00 F0 41 0B FE D0 3F 2A 00 20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 28 00 06 00 9A 99 39 41 00 00 01 01 00 00 10 00 05 00 CD CC 4C 3E CD CC CC 3D A2 32 2F 42 31 08 33 42 DF 06 20 03 4F 56 4F 2D 43 00 00 00 00 00 F0 42 01 00 01 00 41 72 20 43 48 34 00 00 00 00 00 00 00 00 00 00 67 66 86 41 9A 99 19 42 CD CC CC 3E 00 00 00 00 00 00 00 00 CD CC CC 3E 31 2E 30 30 20 64 65 67 72 2E 00 00 00 00 00 00 33 34 20 6D 6D 00 00 00 00 00 00 00 00 00 00 00 4E 6F 6E 65 00 00 00 00 00 00 00 00 00 00 00 00 00 00 34 42 1B 00 81 00 AF 00 00 00 00 00 1E 00 13 00 43 20 20 4B 41 31 2D 41 4C 54 2F 41 6C 67 65 72 47 46 46 14 00 08 00 3D 0A 14 42 94 C5 C4 3D 10 00 1A 00 00 00 43 20 20 4B 41 31 2D 41 4C 54 2F 41 A2 32 2F 42 00 00 90 41 CA 25 59 42 2A 00 20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 28 00 06 00 EC C4 9E 40 00 00 15 01 00 00 10 00 05 00 CD CC 4C 3E CD CC CC 3D F6 9D 09 42 11 28 FD 41 D4 06 20 03 4F 56 4F 2D 4E 00 00 00 00 00 D6 42 01 00 01 00 41 72 20 43 48 34 00 00 00 00 00 00 00 00 00 00 67 66 86 41 9A 99 19 42 CD CC CC 3E 00 00 00 00 00 00 00 00 CD CC CC 3E 31 2E 30 30 20 64 65 67 72 2E 00 00 00 00 00 00 33 34 20 6D 6D 00 00 00 00 00 00 00 00 00 00 00 4E 6F 6E 65 00 00 00 00 00 00 00 00 00 00 00 00 00 00 34 42 1B 00 81 00 AF 00 00 00 00 00 09 00 10 00 A1 5F 15 3F 24 9C EA BF 00 00 00 00 00 00 00 00 1E"
  b <- transformssd(hex_data = a)
  c <- data.frame(Sample = "sample001",
                  Date = "01.01.2020 14:00:00",
                  As.Int = 1.632753,
                  C.Int = 54.2869)

  expect_s3_class(b, "data.frame")
  expect_equal(nrow(b), 1)
  expect_equal(ncol(b), 4)
  expect_equal(dim(b), dim(c))
})


test_that("Error message works", {
  a <- "53 53 44 33 12 00 00 00 73 61 1R"

  expect_error(transformssd(hex_data = a))
})
